import{a as G}from"./chunk-CQQZDJZ5.js";import{b as W,c as q,d as B,e as R,f as Q,g as H,l as $,m as Y}from"./chunk-OC3NIF5T.js";import{$ as w,C as s,F as b,G as I,Ga as M,Ha as j,K as _,O as f,P as t,Q as n,R as C,S as P,T as g,U as d,W as L,Y as V,Z as i,_ as u,da as x,ea as h,fa as v,ia as y,ka as U,m as k,ma as A,p as S,qa as F,r as m,ra as z,s as p,ta as N,va as T,w as E,xa as D}from"./chunk-YAHRTPNZ.js";var O=class c{constructor(r){this.http=r}apiUrl=`${M.apiUrl}/auth/users`;getUsers(){return this.http.get(this.apiUrl)}getUser(r){return this.http.get(`${this.apiUrl}/${r}`)}createUser(r){return this.http.post(`${M.apiUrl}/auth/register`,r)}deleteUser(r){return this.http.delete(`${this.apiUrl}/${r}`)}changePassword(r){return this.http.post(`${M.apiUrl}/auth/change-password`,r)}static \u0275fac=function(e){return new(e||c)(S(D))};static \u0275prov=k({token:c,factory:c.\u0275fac,providedIn:"root"})};function X(c,r){if(c&1){let e=P();t(0,"tr",22)(1,"td")(2,"div",23)(3,"div",24),i(4),n(),t(5,"div",25)(6,"span",26),i(7),n(),t(8,"span",27),i(9),n()()()(),t(10,"td")(11,"span",28),i(12),n()(),t(13,"td")(14,"span",29),i(15),y(16,"date"),n()(),t(17,"td")(18,"span",29),i(19),y(20,"date"),n()(),t(21,"td",18)(22,"div",30)(23,"button",31),g("click",function(){let a=m(e).$implicit,l=d();return p(l.deleteUser(a))}),C(24,"i",32),n()()()()}if(c&2){let e=r.$implicit,o=d();s(3),L("background-color",o.getAvatarColor(e.username)),s(),w(" ",e.username[0].toUpperCase()," "),s(3),u(e.username),s(2),u(e.id),s(2),V(e.role||"admin"),s(),w(" ",e.role||"Admin"," "),s(3),u(U(16,11,e.created_at,"medium")),s(4),u(U(20,14,e.updated_at,"medium")),s(4),f("disabled",o.isCurrentUser(e))}}function ee(c,r){c&1&&(t(0,"div",33)(1,"p"),i(2,"No se encontraron usuarios."),n()())}function te(c,r){if(c&1){let e=P();t(0,"div",34),g("click",function(){m(e);let a=d();return p(a.showCreateForm=!1)}),t(1,"div",35),g("click",function(a){return m(e),p(a.stopPropagation())}),t(2,"div",36)(3,"h2"),i(4,"Crear Nuevo Usuario"),n(),t(5,"button",37),g("click",function(){m(e);let a=d();return p(a.showCreateForm=!1)}),i(6,"\xD7"),n()(),t(7,"form",38),g("submit",function(a){m(e);let l=d();return p(l.createUser(a))}),t(8,"div",39)(9,"label",40),i(10,"Nombre de Usuario"),n(),t(11,"input",41),v("ngModelChange",function(a){m(e);let l=d();return h(l.newUser.username,a)||(l.newUser.username=a),p(a)}),n()(),t(12,"div",39)(13,"label",42),i(14,"Contrase\xF1a"),n(),t(15,"input",43),v("ngModelChange",function(a){m(e);let l=d();return h(l.newUser.password,a)||(l.newUser.password=a),p(a)}),n()(),t(16,"div",44)(17,"button",45),g("click",function(){m(e);let a=d();return p(a.showCreateForm=!1)}),i(18,"Cancelar"),n(),t(19,"button",46),i(20,"Crear Usuario"),n()()()()()}if(c&2){let e=d();s(11),x("ngModel",e.newUser.username),s(4),x("ngModel",e.newUser.password),s(4),f("disabled",!e.isFormValid())}}var Z=class c{constructor(r,e,o){this.userService=r;this.dialogService=e;this.authService=o}users=E([]);searchQuery="";showCreateForm=!1;newUser={username:"",password:""};filteredUsers=A(()=>{let r=this.searchQuery.toLowerCase();return this.users().filter(e=>e.username.toLowerCase().includes(r))});ngOnInit(){this.loadUsers()}loadUsers(){this.userService.getUsers().subscribe(r=>{this.users.set(r)})}isCurrentUser(r){return this.authService.currentUser()?.id===r.id}getAdminCount(){return this.users().filter(r=>(r.role||"admin")==="admin").length}getAvatarColor(r){let e=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"],o=r.length%e.length;return e[o]}async deleteUser(r){await this.dialogService.confirm({title:"Eliminar Usuario",message:`\xBFEst\xE1s seguro de que deseas eliminar al usuario "${r.username}"? Esta acci\xF3n no se puede deshacer.`,confirmText:"Eliminar",type:"danger"})&&this.userService.deleteUser(r.id).subscribe(()=>{this.loadUsers()})}isFormValid(){return this.newUser.username.length>=3&&this.newUser.password.length>=6}createUser(r){r.preventDefault(),this.isFormValid()&&this.userService.createUser(this.newUser).subscribe({next:()=>{this.loadUsers(),this.showCreateForm=!1,this.newUser={username:"",password:""}},error:e=>{alert("Error al crear usuario: "+(e.error?.message||"Error desconocido"))}})}static \u0275fac=function(e){return new(e||c)(b(O),b(G),b(j))};static \u0275cmp=I({type:c,selectors:[["app-user-list"]],decls:44,vars:6,consts:[[1,"user-list-container"],[1,"header-section"],[1,"title-area"],[1,"subtitle"],[1,"actions-group"],[1,"btn-add",3,"click"],[1,"fa-solid","fa-plus"],[1,"stats-row"],[1,"stat-card"],[1,"value"],[1,"label"],[1,"value","success"],[1,"filters-bar","glass"],[1,"search-box"],[1,"fa-solid","fa-magnifying-glass","search-icon"],["type","text","placeholder","Buscar por nombre de usuario...",3,"ngModelChange","ngModel"],[1,"table-card"],[1,"user-table"],[1,"actions-cell"],["class","user-row",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"user-row"],[1,"user-info-cell"],[1,"avatar"],[1,"info-text"],[1,"name"],[1,"subtext"],[1,"role-pill"],[1,"date-text"],[1,"action-buttons"],["title","Eliminar",1,"icon-btn-plain","danger",3,"click","disabled"],[1,"fa-solid","fa-trash"],[1,"empty-state"],[1,"modal-overlay",3,"click"],[1,"modal-content","glass",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"user-form",3,"submit"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","required","","placeholder","Ej: admin_alt",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","","placeholder","M\xEDnimo 6 caracteres",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-submit",3,"disabled"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),i(4,"Usuarios"),n(),t(5,"p",3),i(6,"Administrar los usuarios con acceso al panel de control"),n()(),t(7,"div",4)(8,"button",5),g("click",function(){return o.showCreateForm=!0}),C(9,"i",6),i(10," Nuevo Usuario "),n()()(),t(11,"div",7)(12,"div",8)(13,"span",9),i(14),n(),t(15,"span",10),i(16,"Total Usuarios"),n()(),t(17,"div",8)(18,"span",11),i(19),n(),t(20,"span",10),i(21,"Administradores"),n()()(),t(22,"div",12)(23,"div",13),C(24,"i",14),t(25,"input",15),v("ngModelChange",function(l){return h(o.searchQuery,l)||(o.searchQuery=l),l}),n()()(),t(26,"div",16)(27,"table",17)(28,"thead")(29,"tr")(30,"th"),i(31,"USUARIO"),n(),t(32,"th"),i(33,"ROL"),n(),t(34,"th"),i(35,"FECHA CREACI\xD3N"),n(),t(36,"th"),i(37,"\xDALTIMA ACTUALIZACI\xD3N"),n(),t(38,"th",18),i(39,"ACCIONES"),n()()(),t(40,"tbody"),_(41,X,25,17,"tr",19),n()(),_(42,ee,3,0,"div",20),n()(),_(43,te,21,3,"div",21)),e&2&&(s(14),u(o.users().length),s(5),u(o.getAdminCount()),s(6),x("ngModel",o.searchQuery),s(16),f("ngForOf",o.filteredUsers()),s(),f("ngIf",o.users().length===0),s(),f("ngIf",o.showCreateForm))},dependencies:[T,F,z,Y,H,W,q,B,$,Q,R,N],styles:[".user-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.header-section[_ngcontent-%COMP%]   .title-area[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;margin-bottom:.25rem}.header-section[_ngcontent-%COMP%]   .title-area[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.95rem}.btn-add[_ngcontent-%COMP%]{background:#0f172a;color:#fff;font-weight:600;padding:.75rem 1.25rem;border-radius:10px}.btn-add[_ngcontent-%COMP%]:hover{background:#1e293b}.stats-row[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.stat-card[_ngcontent-%COMP%]{background:var(--surface);padding:1.5rem;border-radius:12px;border:1px solid var(--border);display:flex;flex-direction:column;gap:.5rem;min-width:200px}.stat-card[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text)}.stat-card[_ngcontent-%COMP%]   .value.success[_ngcontent-%COMP%]{color:#22c55e}.stat-card[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:.5px}.filters-bar[_ngcontent-%COMP%]{padding:1rem 1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:12px}.filters-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.filters-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:transparent;width:100%;padding:.5rem;font-size:.95rem;color:var(--text)}.filters-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.filters-bar[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#94a3b8}.table-card[_ngcontent-%COMP%]{background:var(--surface);border-radius:12px;border:1px solid var(--border);overflow:hidden}.user-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.user-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem 1.5rem;text-align:left;font-size:.7rem;font-weight:700;color:#94a3b8;text-transform:uppercase;letter-spacing:1px;border-bottom:1px solid var(--border)}.user-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;border-bottom:1px solid var(--border);vertical-align:middle}.user-row[_ngcontent-%COMP%]{transition:background .2s}.user-row[_ngcontent-%COMP%]:hover{background:#f8fafc}.user-info-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-info-cell[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:1rem}.user-info-cell[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.user-info-cell[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:600;color:var(--text);font-size:.95rem}.user-info-cell[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   .subtext[_ngcontent-%COMP%]{font-size:.75rem;color:#94a3b8;font-family:monospace}.role-pill[_ngcontent-%COMP%]{display:inline-flex;padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:700;background:#eff6ff;color:#1e40af}.role-pill.admin[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.date-text[_ngcontent-%COMP%]{font-size:.85rem;color:#64748b}.actions-cell[_ngcontent-%COMP%]{text-align:right}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem}.icon-btn-plain[_ngcontent-%COMP%]{background:transparent;border:none;width:32px;height:32px;display:flex;align-items:center;justify-content:center;color:#94a3b8;font-size:1.1rem;border-radius:6px}.icon-btn-plain[_ngcontent-%COMP%]:hover:not(:disabled){background:#f1f5f9;color:var(--text)}.icon-btn-plain.danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#fef2f2;color:#ef4444}.icon-btn-plain[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem;color:#94a3b8}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0006;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .2s ease}.modal-content[_ngcontent-%COMP%]{background:var(--surface);width:90%;max-width:450px;border-radius:20px;padding:2rem;box-shadow:0 20px 40px #0003;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.34,1.56,.64,1);border:1px solid var(--border);display:flex;flex-direction:column;gap:1.5rem}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:var(--text);display:flex;align-items:center;gap:.75rem}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{font-size:1.5rem;background:transparent;border:none;color:var(--text-muted);cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:var(--border);color:var(--text)}.user-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:var(--text)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.75rem 1rem;border-radius:10px;border:1px solid var(--border);background:var(--bg);color:var(--text);font-size:.9rem;transition:all .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px #6366f11a}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:.5rem;padding-top:1rem;border-top:1px solid var(--border)}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.75rem 1.5rem;border-radius:12px;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s;border:none}.form-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:var(--surface);color:var(--text-muted);border:1px solid var(--border)}.form-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:var(--border);color:var(--text)}.form-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{background:#6366f1;color:#fff}.form-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){background:#4f46e5;transform:translateY(-1px);box-shadow:0 4px 12px #6366f14d}.form-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.dark[_ngcontent-%COMP%]   .table-card[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:#111827;border-color:#1f2937}.dark[_ngcontent-%COMP%]   .user-row[_ngcontent-%COMP%]:hover{background:#1e293b}.dark[_ngcontent-%COMP%]   .btn-add[_ngcontent-%COMP%]{background:#f8fafc;color:#0f172a}.dark[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{background:#6366f1;color:#fff}.dark[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){background:#4f46e5}.dark[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#1f2937;color:#94a3b8;border-color:#374151}.dark[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:#374151;color:#fff}"]})};export{Z as UserListComponent};
